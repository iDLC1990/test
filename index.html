function fillDateSelect(filterType, allData = []) {
  const select = document.getElementById('date-select'); 
  const rangeControls = document.getElementById('date-range-controls');
  select.style.display = (filterType==='range') ? 'none' : 'inline-block';
  rangeControls.style.display = (filterType==='range') ? 'inline-block' : 'none';

  if(filterType==='range'){
    const today = new Date().toISOString().split('T')[0];
    document.getElementById('date-from').value = today;
    document.getElementById('date-to').value = today;
    return;
  }

  // Сбор уникальных значений для select
  const valuesSet = new Set();
  allData.forEach(d => {
    if(!d.date) return;
    const dateObj = new Date(d.date);
    if(isNaN(dateObj)) return;
    if(filterType==='day') {
      valuesSet.add(d.date.split(' ')[0]); // yyyy-mm-dd
    } else if(filterType==='month') {
      valuesSet.add(`${dateObj.getFullYear()}-${String(dateObj.getMonth()+1).padStart(2,'0')}`);
    } else if(filterType==='year') {
      valuesSet.add(`${dateObj.getFullYear()}`);
    } else if(filterType==='week') {
      const firstDayOfWeek = new Date(dateObj);
      firstDayOfWeek.setDate(dateObj.getDate() - dateObj.getDay()); // воскресенье
      const lastDayOfWeek = new Date(firstDayOfWeek);
      lastDayOfWeek.setDate(firstDayOfWeek.getDate() + 6);
      valuesSet.add(`${firstDayOfWeek.toISOString().split('T')[0]}_${lastDayOfWeek.toISOString().split('T')[0]}`);
    }
  });

  const sortedValues = Array.from(valuesSet).sort((a,b)=>a.localeCompare(b));
  select.innerHTML = sortedValues.map(v => `<option value="${v}">${v}</option>`).join('');
}